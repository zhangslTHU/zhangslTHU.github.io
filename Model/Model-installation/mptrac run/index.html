



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Earth Science" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Earth Science" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="Earth Science" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="model" />


<link rel="canonical" href="http://example.com/Model/Model-installation/mptrac%20run/">



  <title>
MPTRAC run - Model installation - Model |
magic zlier = Earth Science = welcome</title>
<meta name="generator" content="Hexo 6.2.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">MPTRAC run
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2022-08-29 09:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2022-08-29T09:00:00+08:00">2022-08-29</time>
  </span>
  <span class="item" title="Symbols count in article">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">Symbols count in article</span>
    <span>18k</span>
    <span class="text">words</span>
  </span>
  <span class="item" title="Reading time">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">Reading time</span>
    <span>16 mins.</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">magic zlier</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://i.loli.net/2020/10/30/rjdhcSgEN8COBPA.jpg"></li>
          <li class="item" data-background-image="https://pic1.zhimg.com/v2-925686c6f46d8312e39d920acb72cb4c_r.jpg?source=1940ef5c"></li>
          <li class="item" data-background-image="https://i.loli.net/2020/10/30/Y1CBXqgeokEs457.jpg"></li>
          <li class="item" data-background-image="https://img-baofun.zhhainiao.com/pcwallpaper_ugc/static/dd451341f0e2a2f02e350dcc764e4fde.jpg"></li>
          <li class="item" data-background-image="http://wx4.sinaimg.cn/large/6833939bly1gicitht3xtj20zk0m8k5v.jpg"></li>
          <li class="item" data-background-image="https://images6.alphacoders.com/817/817452.png"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Model/" itemprop="item" rel="index" title="In Model"><span itemprop="name">Model</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Model/Model-installation/" itemprop="item" rel="index" title="In Model installation"><span itemprop="name">Model installation</span></a>
<meta itemprop="position" content="2" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://example.com/Model/Model-installation/mptrac%20run/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/maomi.jpg">
    <meta itemprop="name" content="SL-Z">
    <meta itemprop="description" content="welcome, DESS, THU">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Earth Science">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>   这里记录了利用<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NsY3MtanNjL21wdHJhYw=="> MPTRAC 模型</span>测试的两个例子以及遇到的问题。在此过程非常感谢 MPTRAC 开发者<span class="exturl" data-url="aHR0cHM6Ly93d3cuZnotanVlbGljaC5kZS9pYXMvanNjL3NsY3M="> Dr. Lars Hoffmann</span> 和 LMZ 的帮助，让我成功测试了自己设计的 case。</p>
<h1 id="1-run-the-example"><a class="markdownIt-Anchor" href="#1-run-the-example">#</a> 1. run the example</h1>
<p>运行官网给的例子，一般前面安装没问题的话，就可以成功运行</p>
<figure class="highlight bash"><figcaption data-lang="bash"><span>h </span></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token builtin class-name">cd</span> mptrac/projects/example</pre></td></tr><tr><td data-num="2"></td><td><pre>$ ./run.sh</pre></td></tr></table></figure><p>重点是理解官网例子脚本的含义，方便自己后面设计实验，代码命令含义参考<span class="exturl" data-url="aHR0cHM6Ly9zbGNzLWpzYy5naXRodWIuaW8vbXB0cmFjL2luZGV4Lmh0bWw="> Doxygen manual</span></p>
<h2 id="1-first-program"><a class="markdownIt-Anchor" href="#1-first-program">#</a> (1) first program</h2>
<p><code>&quot;trac=../../src&quot;</code> : src 目录下（ <code>mptrac/src/</code> ）放着用来计算各种变量的源文件，这一步是用来显示路径的。在 linux 环境 <code>“.”</code>  表示当前工作目录， <code>“./script”</code>  表示执行当前工作目录的脚本文件， <code>“..”</code>  表示当前目录的上一级；因为 run.sh 文件在 <code>mptrac/projects/example/</code>  下，要调用 src 下面的包，则需要先返回到 mptrac 目录下，即 “…/…/”</p>
<p><code>&quot;rm -rf data plots &amp;&amp; mkdir -p data plots&quot;</code> : 每次在创建新的文件夹存放数据和画图前先删除上次的结果，防止出错。因为此文件位置在 <code>mptrac/projects/example</code>  下，所以生成的 data 和 plots 文件夹均在相同目录下，之后出现的 <code>data/文件</code> 均表示 <code>mptrac/projects/example/data/</code>  目录下的对应文件</p>
<p><code>&quot;time2jsec&quot;</code> : Convert date to Julian seconds， <code>t0,t1</code>  分别是模拟开始和结束的时间</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Setup...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">trac</span><span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/src</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># Create directories...</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> data plots <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> data plots</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># Set timestep and timerange of simulation...</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">t0</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>$trac/time2jsec <span class="token number">2011</span> <span class="token number">6</span> <span class="token number">5</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token variable">)</span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">t1</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>$trac/time2jsec <span class="token number">2011</span> <span class="token number">6</span> <span class="token number">8</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token variable">)</span></span></pre></td></tr></table></figure><h2 id="2-second-program"><a class="markdownIt-Anchor" href="#2-second-program">#</a> (2) second program</h2>
<p>在 bash 中 <code>EOF</code>  是把多行输入作为一个 program 输入 (The EOF is used in bash to provide multi line input to a program,<span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjUwMDQzNi9ob3ctZG9lcy1jYXQtZW9mLXdvcmstaW4tYmFzaA=="> 链接</span>)，两个之间 EOF 之间表示 input。<br>
the  <code>&quot;$&quot;</code>  symbol is used to define variables in the bash script<span class="exturl" data-url="aHR0cHM6Ly90bGRwLm9yZy9IT1dUTy9CYXNoLVByb2ctSW50cm8tSE9XVE8tNS5odG1s"> 链接</span><br>
 <code>&gt;</code> outputs to a file,  <code>&gt;&gt;</code>  appends to a file,  <code>&lt;</code>  reads input from file.  <code>data/trac.ctl</code>  表示的是刚刚新建的 data 目录 (mptrac/projects/example/data) 下的 trac.ctl 文件，合起来就是把计算出来的结果输出到 data 目录下的 trac.ctl 文件</p>
<p><code>NQ</code> : Number of quantities. their names (QNT_NAME[]) and units (QNT_UNIT[])<br>
 t 气温，uvw 风速，z: Geopotential height at model levels (km)，ps 地表气压，pv 位涡，pt 对流层顶气压，h2o 水汽混合比，m: mass of species，theta 位温<br>
其中温度，风场，海平面气压，（地表）位势高度是必须的 input（如果不是气压层数据，需要额外给模式对应的气压），水汽是根据所求的目标提供，位温位涡等变量都是模式根据提供的变量利用公式计算得到的</p>
<p><code>metbase</code> :Basename for meteo (input) data, <code>../../tests/data/ei</code>  表示模式将会读取 <code>mptrac/tests/data/</code>  目录下所有以 <code>ei</code>  开头（或含有 ei）的输入数据，这是用来读取输入数据的。若输入数据不在 tests 目录下，则修改此命令对应目录位置即可。<br>
remove the line “SPECIES = SO2” means the species is generic/not specified 未指定某个物质<br>
 <code>DT_MET</code> ：Time step of meteo data 输入气象数据的时间间隔，每两个 nc 文件之间的相差时间 (s)（例子是每 24h=24*3600s 一个输入文件）<br>
 <code>MET_DT_OUT</code> ：Time step for sampling of meteo data along trajectories (s) 采样时间（output）<br>
 <code>CLIM_OH_FILENAME</code> : Filename of OH climatology. 氢基氧基<br>
 <code>BOUND_MASS</code> : Boundary conditions mass per particle [kg].<br>
 <code>BOUND_DPS</code> : Boundary conditions delta to surface pressure [hPa].<br>
 <code>CONV_CAPE</code> : CAPE threshold for convection module [J/kg].<br>
 <code>t_stop</code> : Stop time of simulation [s].<br>
 <code>TDEC_TROP</code> : Life time of particles (troposphere) [s].<br>
 <code>TDEC_STRAT</code> : Life time of particles (stratosphere) [s]. 如果去掉这两个命令，则表示粒子有着无限长的生命周期.<br>
 <code>grid_lon0,grid_lon1,grid_lat0,grid_lat1</code> : （模拟出的）格点数据经纬度边界范围.<br>
 <code>grid_nx,grid_ny</code> : 格点数据经纬度数据（与设置的经纬度范围一起就可以设置出经纬度间隔 / 分辨率，可与输入数据的间隔不同）</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Create control parameter file...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">cat</span> <span class="token operator">></span> data/trac.ctl <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span></pre></td></tr><tr><td data-num="3"></td><td><pre>NQ = 9</pre></td></tr><tr><td data-num="4"></td><td><pre>QNT_NAME[0] = t</pre></td></tr><tr><td data-num="5"></td><td><pre>QNT_NAME[1] = u</pre></td></tr><tr><td data-num="6"></td><td><pre>QNT_NAME[2] = v</pre></td></tr><tr><td data-num="7"></td><td><pre>QNT_NAME[3] = w</pre></td></tr><tr><td data-num="8"></td><td><pre>QNT_NAME[4] = z</pre></td></tr><tr><td data-num="9"></td><td><pre>QNT_NAME[5] = pv</pre></td></tr><tr><td data-num="10"></td><td><pre>QNT_NAME[6] = ps</pre></td></tr><tr><td data-num="11"></td><td><pre>QNT_NAME[7] = pt</pre></td></tr><tr><td data-num="12"></td><td><pre>QNT_NAME[8] = m</pre></td></tr><tr><td data-num="13"></td><td><pre>METBASE = ../../tests/data/ei</pre></td></tr><tr><td data-num="14"></td><td><pre>MET_DT_OUT = 86400.0</pre></td></tr><tr><td data-num="15"></td><td><pre>CLIM_OH_FILENAME = ../../data/clams_radical_species.nc</pre></td></tr><tr><td data-num="16"></td><td><pre>SPECIES = SO2</pre></td></tr><tr><td data-num="17"></td><td><pre>BOUND_MASS = 0.0</pre></td></tr><tr><td data-num="18"></td><td><pre>BOUND_DPS = 100.0</pre></td></tr><tr><td data-num="19"></td><td><pre>CONV_CAPE = 0.0</pre></td></tr><tr><td data-num="20"></td><td><pre>TDEC_TROP = 259200.0</pre></td></tr><tr><td data-num="21"></td><td><pre>TDEC_STRAT = 259200.0</pre></td></tr><tr><td data-num="22"></td><td><pre>DT_MET = 86400.0</pre></td></tr><tr><td data-num="23"></td><td><pre>T_STOP = <span class="token variable">$t1</span></pre></td></tr><tr><td data-num="24"></td><td><pre>GRID_LON0 = -90</pre></td></tr><tr><td data-num="25"></td><td><pre>GRID_LON1 = 60</pre></td></tr><tr><td data-num="26"></td><td><pre>GRID_LAT0 = -60</pre></td></tr><tr><td data-num="27"></td><td><pre>GRID_LAT1 = -15</pre></td></tr><tr><td data-num="28"></td><td><pre>GRID_NX = 300</pre></td></tr><tr><td data-num="29"></td><td><pre>GRID_NY = 90</pre></td></tr><tr><td data-num="30"></td><td><pre>EOF</pre></td></tr></table></figure><h2 id="3-third-program"><a class="markdownIt-Anchor" href="#3-third-program">#</a> (3) third program</h2>
<p>前面定义了 <code>trac=../../src</code> ，用来表示 src 的目录，并用 <code>$</code>  来定义此变量以便调用。 <code>$trac/atm_init</code>  表示调用 src 目录下 atm_init 源文件，初始化上一步读取的数据和定义的变量（data/trac.ctl），并把最后的结果输出到 atm_init.tab 文件（ <code>tab文件是存放结果的</code> ）；并定义了初始化的时间、高度 [km]、经纬度，因为初始化的是一个点，所以 t/z/lon/lat_0 和 t/z/lon/lat_1 应该是相同的</p>
<p>接下来调用 atm_split，作用 It splits the initial small set into a larger set of air parcels (create a larger set of air parcel positions)。其中 N 是 parcel 的个数，M 是总质量，dx 和 dz 是高斯分布里面的半高宽；x 是水平方向，z 是垂直方向。</p>
<p><code>atm files</code>  (which is position and quantities of all the air parcels at a given time) and  <code>grid files</code>  (which is mean/integrated data of all the air parcels on a regular lon-lat grid).<br>
the variables  <code>ATM_BASENAME</code>  and  <code>GRID_BASENAME</code>  give the basename for the output. For example “atm” will be expanded to “atm_2000_01_01_00_00.tab, atm_2000_01_01_06_00.tab” … 因此最后一步会计算 atm 和 grid 两种结果，并把对应的结果存放在 atm_xxx.tab 和 grid_xxx.tab 文件里。<br>
the output frequency is set by  <code>ATM_DT_OUT</code></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Set initial air parcel positions...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$trac</span>/atm_init data/trac.ctl data/atm_init.tab <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	       INIT_T0 <span class="token string">"<span class="token variable">$t0</span>"</span> INIT_T1 <span class="token string">"<span class="token variable">$t0</span>"</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	       INIT_Z0 <span class="token number">10.0</span> INIT_Z1 <span class="token number">10.0</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	       INIT_LON0 <span class="token parameter variable">-72.117</span> INIT_LON1 <span class="token parameter variable">-72.117</span> <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	       INIT_LAT0 <span class="token parameter variable">-40.59</span> INIT_LAT1 <span class="token parameter variable">-40.59</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># Split air parcels...</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token variable">$trac</span>/atm_split data/trac.ctl data/atm_init.tab data/atm_split.tab <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		SPLIT_N <span class="token number">10000</span> SPLIT_M 1e9 SPLIT_DX <span class="token number">30.0</span> SPLIT_DZ <span class="token number">1.0</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># Calculate trajectories...</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token builtin class-name">echo</span> <span class="token string">"data"</span> <span class="token operator">></span> data/dirlist</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token variable">$trac</span>/trac data/dirlist trac.ctl atm_split.tab <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	   ATM_BASENAME atm GRID_BASENAME grid</pre></td></tr></table></figure><h2 id="4-fourth-program"><a class="markdownIt-Anchor" href="#4-fourth-program">#</a> (4) fourth program</h2>
<p><code>echo</code>  命令的输出内容如果没有特殊含义，则原内容输出到屏幕；如果输出内容有特殊含义，则输出打印其含义。echo 命令的功能是在显示器上显示一段文字， <code>一般起到一个提示的作用</code> <br>
 <code>for</code>  循环与 <code>do,echo,done</code>  一起用<br>
 <code>ls data/atm_2011*tab</code>  ：ls 表示打印出当前目录的清单，这个命令就是打印出 <code>mptrac/projects/example/data/</code>  目录下含有 <code>atm_2011</code>  的 tab 文件的文件名；放到 for 循环里， <code>f</code>  就是含有 <code>atm_2011</code>  的文件名（如 atm_2000_01_01_00_00.tab, atm_2000_01_01_06_00.tab,…）<br>
 <code>echo &quot;Plot $f ...&quot;</code>  这一句命令是输出到显示屏上，提醒现在画的是哪一副图； <code>set out &quot;plots/$(basename $f).png&quot;</code>  是 gnuplot 的绘图命令，表示最后生成图片的名字（输出文件名）</p>
<p><code>$(basename &quot;$f&quot; .tab | awk 'BEGIN&#123;FS=&quot;_&quot;&#125;&#123;print $2&quot;-&quot;$3&quot;-&quot;$4&quot;, &quot;$5&quot;:&quot;$6&quot; UTC&quot;&#125;'</code> ：basename 命令会删掉所有的前缀包括最后一个 slash（‘/’）字符，然后将字符串显示出来； <code>basename &quot;$f&quot; .tab</code>  就是把 f 的文件名去掉 <code>.tab</code> ，只留前面的文件名。awk 是 bash 里的文本处理工具（遍历文本）,FS (Field Separator) 是与 awk 连用的列分割符：决定了将一行划分为几段，预设值是 空白符 (空白和 Tab)。<br>
所以这一句的命令就是把 <code>f对应的文件名(如atm_2011_06_05_00_00.tab)</code>  去掉.tab 后剩下的文件名 ( <code>如atm_2011_06_05_00_00</code> )，遍历文本，用 <code>_</code> 分割为 6 份（用 1-6 数字表示，如 1 表示 atm），之后输出 2-6 的内容，并用 <code>-</code>  和 <code>:</code>  连接，所以最后 <code>t</code>  的内容就是如 <code>2011-06-05,00:00</code></p>
<p><code>set terminal pngcairo size 1000,1000 font 'Times New Roman,10'</code>   格式，大小和字体<br>
 <code>cbra</code>  colorbar range<br>
 <code>cbla</code>  colorbar label<br>
 <code>set mxticks</code>  设置 x 轴子刻度数目</p>
<p>plot 用于绘制 2D 函数和数据，关于 gnuplot 画图的详细命令可以看<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODQ2ODA3Ny9hcnRpY2xlL2RldGFpbHMvMTAxMDY5MzY1">超详细的 gnuplot 使用教程</span>。gnuplot 可以读取 txt,dat 等格式文件。<br>
 <code>plot &quot;$f&quot;</code>  表示读取 tab 文件， <code>u 3:4:(1.*\$2)</code>  u=using，表示用文件的第三，四列作图； <code>w d lc pal z t &quot;&quot;</code> ,w=with (with 后边跟需要指定的样式),  <code>d=dots</code>  每一点绘一细点， <code>lc=line color</code>  曲线颜色， <code>t &quot;&quot;</code> t=title 标题为空</p>
<p><code>&quot;../data/wcl.tab&quot; u 1:2 w l lt -1 t &quot;&quot;</code>  读取 wcl.tab 文件的数据的前两列（u 1:2 表示使用文件中 1，2 列作为 x，y 作图）， <code>l=line</code> ：用曲线表示， <code>lt -1</code> ：lt=LineType 线型，主要设置的是线条颜色，-1 表示颜色，标题为空</p>
<p><code>&quot;-&quot; u 1:2 w p pt 9 ps 3 lc rgbcolor &quot;red&quot; t &quot;&quot;</code>  读取文件前两列， <code>p:points</code>  用点表示， <code>pt 9</code> :pointtype 点的样式 / 形状是实心正三角， <code>ps 3</code> ：pointsize 点的大小是 3, <code>lc rgbcolor &quot;red&quot;</code>  曲线颜色是红色，标题为空</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Plot air parcel data...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> <span class="token for-or-select variable">f</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> data/atm_2011*tab<span class="token variable">)</span></span> <span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"Plot <span class="token variable">$f</span> ..."</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token assign-left variable">t</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> <span class="token string">"<span class="token variable">$f</span>"</span> .tab <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'BEGIN&#123;FS="_"&#125;&#123;print $2"-"$3"-"$4", "$5":"$6" UTC"&#125;'</span><span class="token variable">)</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    gnuplot <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span></pre></td></tr><tr><td data-num="7"></td><td><pre>set out "plots/<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $f<span class="token variable">)</span></span>.png"</pre></td></tr><tr><td data-num="8"></td><td><pre>set term png truecolor crop linewidth 2 font "Helvetica" 24 size 1440,900</pre></td></tr><tr><td data-num="9"></td><td><pre>set size ratio 0.75</pre></td></tr><tr><td data-num="10"></td><td><pre>set pal def</pre></td></tr><tr><td data-num="11"></td><td><pre>set cbra [5:15]</pre></td></tr><tr><td data-num="12"></td><td><pre>set cbla "altitude [km]"</pre></td></tr><tr><td data-num="13"></td><td><pre>set xla "longitude [deg]"</pre></td></tr><tr><td data-num="14"></td><td><pre>set yla "latitude [deg]"</pre></td></tr><tr><td data-num="15"></td><td><pre>set xtics 30</pre></td></tr><tr><td data-num="16"></td><td><pre>set ytics 10</pre></td></tr><tr><td data-num="17"></td><td><pre>set mxtics 6</pre></td></tr><tr><td data-num="18"></td><td><pre>set mytics 5</pre></td></tr><tr><td data-num="19"></td><td><pre>set xra [-90:60]</pre></td></tr><tr><td data-num="20"></td><td><pre>set yra [-60:-15]</pre></td></tr><tr><td data-num="21"></td><td><pre>set grid</pre></td></tr><tr><td data-num="22"></td><td><pre>set title "MPTRAC | <span class="token variable">$t</span>"</pre></td></tr><tr><td data-num="23"></td><td><pre>plot "<span class="token variable">$f</span>" u 3:4:(1.*\<span class="token variable">$2</span>) w d lc pal z t "", \</pre></td></tr><tr><td data-num="24"></td><td><pre>    "../data/wcl.tab" u 1:2 w l lt -1 t "", \</pre></td></tr><tr><td data-num="25"></td><td><pre>    "-" u 1:2 w p pt 9 ps 3 lc rgbcolor "red" t ""</pre></td></tr><tr><td data-num="26"></td><td><pre>-72.117 -40.59</pre></td></tr><tr><td data-num="27"></td><td><pre>e</pre></td></tr><tr><td data-num="28"></td><td><pre>EOF</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">done</span></pre></td></tr></table></figure><h2 id="5-fifth-program"><a class="markdownIt-Anchor" href="#5-fifth-program">#</a> (5) fifth program</h2>
<p>在这一部分命令与上面一个大致相同，但 <code>splot</code>  绘制 3D 曲面和数据的 2D 投影。<br>
 <code>set pm3d</code>  设置当前为 pm3d 模式，构造一个有颜色的非透明的图形（三维）<br>
 <code>set pal def ()</code>  改变 pm3d 默认色板</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Plot grid data...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span> <span class="token for-or-select variable">f</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> data/grid_2011*tab<span class="token variable">)</span></span> <span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"Plot <span class="token variable">$f</span> ..."</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token assign-left variable">t</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> <span class="token string">"<span class="token variable">$f</span>"</span> .tab <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'BEGIN&#123;FS="_"&#125;&#123;print $2"-"$3"-"$4", "$5":"$6" UTC"&#125;'</span><span class="token variable">)</span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    gnuplot <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span></pre></td></tr><tr><td data-num="6"></td><td><pre>set out "plots/<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $f<span class="token variable">)</span></span>.png"</pre></td></tr><tr><td data-num="7"></td><td><pre>set term png truecolor crop linewidth 2 font "Helvetica" 24 size 1440,900</pre></td></tr><tr><td data-num="8"></td><td><pre>set size ratio 0.75</pre></td></tr><tr><td data-num="9"></td><td><pre>set pm3d map interp 4,4</pre></td></tr><tr><td data-num="10"></td><td><pre>set pal def (0 'gray90', 1 'blue', 2 'cyan', 3 'green', 4 'yellow', 5 'orange', 6 'red')</pre></td></tr><tr><td data-num="11"></td><td><pre>set cbla "column density [g/m^2]"</pre></td></tr><tr><td data-num="12"></td><td><pre>set cbra [0:1]</pre></td></tr><tr><td data-num="13"></td><td><pre>set xla "longitude [deg]"</pre></td></tr><tr><td data-num="14"></td><td><pre>set yla "latitude [deg]"</pre></td></tr><tr><td data-num="15"></td><td><pre>set xtics 30</pre></td></tr><tr><td data-num="16"></td><td><pre>set ytics 10</pre></td></tr><tr><td data-num="17"></td><td><pre>set mxtics 6</pre></td></tr><tr><td data-num="18"></td><td><pre>set mytics 5</pre></td></tr><tr><td data-num="19"></td><td><pre>set xra [-90:60]</pre></td></tr><tr><td data-num="20"></td><td><pre>set yra [-60:-15]</pre></td></tr><tr><td data-num="21"></td><td><pre>set grid</pre></td></tr><tr><td data-num="22"></td><td><pre>set title "MPTRAC | <span class="token variable">$t</span>"</pre></td></tr><tr><td data-num="23"></td><td><pre>splot "<span class="token variable">$f</span>" u 3:4:(1e3*\<span class="token variable">$8</span>) t "", \</pre></td></tr><tr><td data-num="24"></td><td><pre>    "../data/wcl.tab" u 1:2:(0) w l lt -1 t "", \</pre></td></tr><tr><td data-num="25"></td><td><pre>    "-" u 1:2:3 w p pt 9 ps 3 lc rgbcolor "red" t ""</pre></td></tr><tr><td data-num="26"></td><td><pre>-72.117 -40.59 0</pre></td></tr><tr><td data-num="27"></td><td><pre>e</pre></td></tr><tr><td data-num="28"></td><td><pre>EOF</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">done</span></pre></td></tr></table></figure><h1 id="2-run-the-case-of-2021-henan-precipitation"><a class="markdownIt-Anchor" href="#2-run-the-case-of-2021-henan-precipitation">#</a> 2. run the case of 2021 Henan precipitation</h1>
<p>据开发者 Lars 所言： <code>Preparing/converting the meteo data for use with MPTRAC is maybe the most difficult step in getting the model running for a new study</code> 。对使用 MPTRAC 的人来说，准备数据是最麻烦也最容易出错的一个过程，以之前跑 MPTRAC 的经验来说，当 input data 不符合 MPTRAC 的要求时，model 往往会报错。故我们首先需要了解 input data 时哪些。</p>
<p>根据<span class="exturl" data-url="aHR0cHM6Ly9kb2kub3JnLzEwLjUxOTQvZ21kLTE1LTI3MzEtMjAyMg==">原文</span>:<br>
At a minimum, MPTRAC requires  <code>3-D fields</code>  of temperature  <code>T</code>  , zonal wind  <code>u</code> , and meridional wind  <code>v</code> . The vertical velocity  <code>ω</code> , specific humidity  <code>q</code> , ozone mass mixing ratio  <code>x_O3</code>  , cloud liquid water content ( <code>CLWC</code> ), cloud rain water content ( <code>CRWC</code> ), cloud ice water content ( <code>CIWC</code> ), and cloud snow water content ( <code>CSWC</code> ) are  <code>optional</code>  but often needed for specific applications. The model also requires the surface pressure  <code>ps</code>  or log-surface pressure ( <code>ln ps</code> ) and the geopotential height at the surface  <code>Z_g</code> to be provided as  <code>2-D fields</code> . Optionally, near-surface temperature  <code>T_2m</code>  and near-surface winds ( <code>u_10m,v_10m</code> ) can be ingested from the input files.<br>
The model requires the input data in terms of separate NetCDF files at regular time steps. all the meteo variables will be have to be included in the same file.</p>
<p>也就是说 input data 必须需要包含 <code>三维数据（pressure levels）：温度t，风场uvw，比湿q，臭氧O3</code> ； <code>二维数据（surface level）:地表气压ps，地表位势高度z</code> 。除此之外，我们还习惯在 input data 里加入一些其它三维数据：云水、云雨、云冰、云雪含量（ <code>clwc,crwc,ciwc,cswc</code> ）和二维数据：地表 2 米气温（ <code>t2m</code> ）和 10 米风速（ <code>u10m,v10m</code> ）。</p>
<p>需要注意的是，input data 是按时间来区分的，也就是说准备每一个的 input data 都只有一个时间（ <code>时间维度是1</code> ），并且应该包含所有所需变量。</p>
<details class="primary"><summary>重点!</summary><div>
<ul>
<li>input data 文件命名形式 <code>ei_20xx_MM_DD_00.nc</code> ，没有分钟项</li>
<li>MPTRAC 的时间是 double，如 <code>20180719.5</code>  表示 <code>2018年7月19日中午12点</code></li>
<li>MPTRAC 通过 <code>name of the dimension</code>  来区分 input data，而不是常见的 <code>standard name</code>  或  <code>long name</code> ，dimension 的 name 必须是 <code>time,lev,lat,lon</code></li>
<li>input data 必须是 <code>全球数据</code> （0：360.-90：90），不可以是提前处理好的某一区域数据（即使研究范围不是全球也要输入全球数据），不然在读完第一个时段的数据后会一直卡着不动</li>
<li>input data 的变量名形式必须完全统一，全部大写或全部小写（ <code>CIWC,CIWC</code>  或  <code>ciwc,clwc</code> ）。此外对变量名称也有要求，必须与模式规定的变量名一致，即与上面原文写的变量名一致（如 era5 中地表气压的变量是 <code>sp</code> ，模式不能识别，能够识别的是 <code>ps</code>  或 <code>lnsp</code> ）</li>
<li>压力数据必须是 <code>降序</code>  (从高到低，1000 hPa, 900 hPa, 850 hPa…)，不然报错： <code>pressure levels must be descending</code></li>
<li>input data 可以没有 <code>o3</code> （常见的大气科学研究中一般不需要），臭氧数据是用来计算化学反应的，若没有 o3 数据模式只会出现警告（warning）而不会报错（error）</li>
</ul>
</div></details>
<h2 id="1-first-method"><a class="markdownIt-Anchor" href="#1-first-method">#</a> (1) first method</h2>
<p>若出现报错： <code>Eorror: NetCDF: Invaild dimension ID or name</code> ，说明维度名没有改正确，要把 <code>time,level,latitude,longitude</code>  改成 <code>time,lev,lat,lon</code> 。<br>
<span class="label primary">修改方法 1</span></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>ds_new <span class="token operator">=</span> d<span class="token punctuation">.</span>swap_dims<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'latitude'</span><span class="token punctuation">:</span><span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'longitude'</span><span class="token punctuation">:</span><span class="token string">'lon'</span><span class="token punctuation">,</span> <span class="token string">'level'</span><span class="token punctuation">:</span><span class="token string">'lev'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token comment"># 将维度名称 level,latitude,longitude 改成 lev,lat,lon</span></pre></td></tr><tr><td data-num="2"></td><td><pre>cc <span class="token operator">=</span> ds_new<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'latitude'</span><span class="token punctuation">:</span><span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'longitude'</span><span class="token punctuation">:</span><span class="token string">'lon'</span><span class="token punctuation">,</span> <span class="token string">'level'</span><span class="token punctuation">:</span><span class="token string">'lev'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token comment"># 将对应的维度坐标名修改</span></pre></td></tr><tr><td data-num="3"></td><td><pre>cc<span class="token punctuation">.</span>to_netcdf<span class="token punctuation">(</span><span class="token string">'path/xxx.nc'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="1.png" alt title="图1 原始数据"><br>
<img data-src="2.png" alt title="图2 修改维度名"><br>
<img data-src="3.png" alt title="图3 修改坐标名"></p>
<h2 id="2-second-method"><a class="markdownIt-Anchor" href="#2-second-method">#</a> (2) second method</h2>
<p><span class="label primary">修改方法 2</span><br>
 除了上面那个方法外，还可以重新构造一个新的 dataset 对维度名进行修改，不过这种方法稍微有点麻烦，适合重构数据情况（如压力坐标和变量名不合要求），常见于 ERA5 数据。ERA5 数据的 pressure level 是升序，且变量名地表气压 <code>sp</code> ，地表 10 米风速 <code>u10,v10</code>  是不合模式要求的，要改成 <code>ps</code> , <code>u10m</code> , <code>v10m</code> 。需要注意的是，除了气压坐标 <code>level</code>  数据需要变成 descend 外，含有 <code>level</code>  维度的变量也需要对应修改，变成 descend。( <code>此处数据处理有一个小问题，更新见第四小节</code> )</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> xarray <span class="token keyword">as</span> xr</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># read file</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token builtin">dir</span> <span class="token operator">=</span> <span class="token string">'path'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>a <span class="token operator">=</span> xr<span class="token punctuation">.</span>open_dataset<span class="token punctuation">(</span><span class="token builtin">dir</span> <span class="token operator">+</span> <span class="token string">'xxx.nc'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># flip 3-D variables and level</span></pre></td></tr><tr><td data-num="9"></td><td><pre>ciwc <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>ciwc<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>clwc <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>clwc<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>q <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>q<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>t <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>t<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>u <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>u<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>v <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>v<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>w <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>w<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>lev <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>level<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># descend</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment"># read 2-D variables and coordinates, modify names</span></pre></td></tr><tr><td data-num="19"></td><td><pre>u10m <span class="token operator">=</span> a<span class="token punctuation">.</span>u10<span class="token punctuation">.</span>values  <span class="token comment"># 只能识别 u10m，不能识别 u10</span></pre></td></tr><tr><td data-num="20"></td><td><pre>v10m <span class="token operator">=</span> a<span class="token punctuation">.</span>v10<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="21"></td><td><pre>t2m <span class="token operator">=</span> a<span class="token punctuation">.</span>t2m<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="22"></td><td><pre>z <span class="token operator">=</span> a<span class="token punctuation">.</span>z<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="23"></td><td><pre>ps <span class="token operator">=</span> a<span class="token punctuation">.</span>sp<span class="token punctuation">.</span>values  <span class="token comment"># ps， 非 sp</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>lon <span class="token operator">=</span> a<span class="token punctuation">.</span>longitude<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="26"></td><td><pre>lat <span class="token operator">=</span> a<span class="token punctuation">.</span>latitude<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="27"></td><td><pre>time <span class="token operator">=</span> a<span class="token punctuation">.</span>time<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment"># create a new dataset</span></pre></td></tr><tr><td data-num="30"></td><td><pre>ds <span class="token operator">=</span> xr<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'ciwc'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  ciwc<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>                 <span class="token string">'clwc'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  clwc<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                 <span class="token string">'q'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  q<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                 <span class="token string">'t'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  t<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                 <span class="token string">'u'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  u<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                 <span class="token string">'v'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  v<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                 <span class="token string">'w'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  w<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                 <span class="token string">'u10m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  u10m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                 <span class="token string">'v10m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  v10m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                 <span class="token string">'t2m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  t2m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                 <span class="token string">'z'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  z<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>                 <span class="token string">'ps'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  ps<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="42"></td><td><pre>                coords<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"time"</span><span class="token punctuation">:</span> time<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="43"></td><td><pre>                        <span class="token string">"lev"</span><span class="token punctuation">:</span> lev<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="44"></td><td><pre>                        <span class="token string">"lat"</span><span class="token punctuation">:</span> lat<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="45"></td><td><pre>                        <span class="token string">"lon"</span><span class="token punctuation">:</span> lon<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>                        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment"># add attributes (optional)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'time'</span></pre></td></tr><tr><td data-num="50"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lev'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'pressure'</span></pre></td></tr><tr><td data-num="51"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lev'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'hPa'</span></pre></td></tr><tr><td data-num="52"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lat'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'latitude'</span></pre></td></tr><tr><td data-num="53"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lat'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'degrees_north'</span></pre></td></tr><tr><td data-num="54"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'longitude'</span></pre></td></tr><tr><td data-num="55"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'degrees_east'</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ciwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cloud ice water content'</span></pre></td></tr><tr><td data-num="58"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ciwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="59"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'clwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cloud liquid water content'</span></pre></td></tr><tr><td data-num="60"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'clwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="61"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Specific humidity'</span></pre></td></tr><tr><td data-num="62"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="63"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Temperature'</span></pre></td></tr><tr><td data-num="64"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'K'</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'U velocity'</span></pre></td></tr><tr><td data-num="67"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'V velocity'</span></pre></td></tr><tr><td data-num="68"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="69"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="70"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Vertical velocity'</span></pre></td></tr><tr><td data-num="71"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Pa s**-1'</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'10 metre U wind component'</span></pre></td></tr><tr><td data-num="74"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'10 metre V wind component'</span></pre></td></tr><tr><td data-num="75"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="76"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="77"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t2m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2 metre temperature'</span></pre></td></tr><tr><td data-num="78"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t2m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'K'</span></pre></td></tr><tr><td data-num="79"></td><td><pre></pre></td></tr><tr><td data-num="80"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Geopotential'</span></pre></td></tr><tr><td data-num="81"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m**2 s**-2'</span></pre></td></tr><tr><td data-num="82"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ps'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Surface_pressure'</span></pre></td></tr><tr><td data-num="83"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ps'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Pa'</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token comment"># generate a new netcdf file</span></pre></td></tr><tr><td data-num="86"></td><td><pre>ds<span class="token punctuation">.</span>to_netcdf<span class="token punctuation">(</span><span class="token builtin">dir</span> <span class="token operator">+</span> <span class="token string">'xxx.nc'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="3-notice"><a class="markdownIt-Anchor" href="#3-notice">#</a> (3) notice</h2>
<p>MPTRAC 跑的结果都存在 <code>tab文件</code> 里，虽然官网例子代码读取了 <code>wcl.tab</code>  文件，但 wcl 是画图用的世界地图轮廓，所以只需要读 atm_xxx.tab 和 grid_xxx.tab 就可以了。<br>
输出变量结果直接打开 tab 文件即可， <code>1，2，...</code>  分别表示第几列，如 <code>$3 = longitude [deg]</code>  表示下面第三列是经度输出数据<br>
<img data-src="4.png" alt title="图4 tab文件输出变量"></p>
<p>此外，据 Lars 所言，MPTRAC 并不适用于边界层的计算，在边界层没有很好的参数化方案，也不适合以 p 坐标作为垂直坐标</p>
<div class="note info">
<p>Just one warning, the MPTRAC model is not designed for the planetary boundary layer (PBL). You can calculate trajectories down to the surface, with surface pressure being the lower boundary of the model. But the MPTRAC model does not have advanced parametrizations of diffusivity in the PBL and pressure as vertical coordinate is also not best choice for the PBL. Our colleagues looking at transport to the surface usually pick the top of the PBL (maybe ~ 1-2 km of altitude above the surface) as the lower boundary to identify the origin/source region of a trajectory.</p>
</div>
<h1 id="3-reference"><a class="markdownIt-Anchor" href="#3-reference">#</a> 3. reference</h1>
<p>(1) <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NsY3MtanNjL21wdHJhYw==">MPTRAC-Github</span><br>
(2) <span class="exturl" data-url="aHR0cHM6Ly9zbGNzLWpzYy5naXRodWIuaW8vbXB0cmFjL2luZGV4Lmh0bWw=">MPTRAC-website/Doxygen manual</span> or <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NsY3MtanNjL21wdHJhYy93aWtp">MPTRAC wiki</span><br>
(3) <span class="exturl" data-url="aHR0cHM6Ly9kb2kub3JnLzEwLjUxOTQvZ21kLTE1LTI3MzEtMjAyMg==">GMD-paper</span><br>
(4) <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODQ2ODA3Ny9hcnRpY2xlL2RldGFpbHMvMTAxMDY5MzY1">超详细的 gnuplot 使用教程</span><br>
 (5) <span class="exturl" data-url="aHR0cHM6Ly93d3cuZG91YmFuLmNvbS9ub3RlLzI0NDg2NjUwNy8/X2k9MTc3MjU0NEZKeEJYWHYsMTc3Mjg3OUZKeEJYWHY=">GNUPLOT 使用小结</span><br>
 (6) <span class="exturl" data-url="aHR0cHM6Ly93d3cubGludXh0b3AuY24vY29tbWFuZC9hd2suaHRtbA==">Linux 常用命令 - awk</span><br>
(7) <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMDM2ODI0L2FydGljbGUvZGV0YWlscy84NTIyNjE2OQ==">SHELL——awk 两个特殊模式（BEGIN 和 END）及 awk 高级应用（条件判断、循环）</span><br>
(8) <span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY2hlbndlbnlhbi9wLzc0NjQ2MTkuaHRtbA==">linux 批量修改分隔符</span><br>
 (9) <span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9iM2I4MWZjYWQ4ZTM=">shell 命令 basename</span><br>
(10) <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hhb3Jhbjg3L2FydGljbGUvZGV0YWlscy8xMjI5NzU1NTc=">shell 脚本 for 循环</span><br>
 (11) <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x4YndvbGYvYXJ0aWNsZS9kZXRhaWxzLzc3ODUyNDQ4">在 shell 脚本中使用 ls 命令的注意事项</span></p>
<h1 id="4-update-on-15-oct-2022"><a class="markdownIt-Anchor" href="#4-update-on-15-oct-2022">#</a> 4. update on 15 Oct 2022</h1>
<p>这一小节记录一些在用 MPTRAC 时新遇到的问题并更正一些错误 (2022.10.15 更新)</p>
<p>之前的重点内容仍然正确且适用，这里补充一些之前遗漏的</p>
<details class="primary"><summary>新增重点!</summary><div>
<ul>
<li>压力坐标（pressure level）的单位必须与地表气压的单位一致，都是 Pa；且垂直方向的层数尽可能多，以便 MPTRAC 在垂直插值的结果正确</li>
<li>initial heights z are actually log-pressure heights</li>
<li>Z output should be geopotential height, and it can be negative if the pressure exceeds the mean slp geoid pressure (i.e., 1013.25 hPa)</li>
<li>使用小时数据作为输入数据时，需要新增 <code>ATM_DT_OUT</code>  和 <code>GRID_DT_OUT</code>  这两个命令</li>
<li>进行后向轨迹模拟时，需要增加 <code>Direction=-1</code>  这个命令，且起始时间和终止时间需要互换</li>
<li>想要生成运行日志（以 log 开头的文件），则在运行 trac 的时候，尾巴上加上一个 <code>| tee log.txt</code></li>
<li></li>
</ul>
</div></details>
<p><span class="label primary">解释说明</span></p>
<ol>
<li>MPTRAC 利用公式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mn>0</mn></msub><mi>e</mi><mi>x</mi><mi>p</mi><mtext>⁡</mtext><mo stretchy="false">(</mo><mfrac><mrow><mo>−</mo><mi>z</mi></mrow><mi>H</mi></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(z)=p_{0} exp⁡(\frac {-z}{H})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1473309999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord">⁡</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.802331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span> 进行气压计算，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><mo>=</mo><mn>1013.25</mn><mi>h</mi><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">p_0=1013.25 hPa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">3</span><span class="mord">.</span><span class="mord">2</span><span class="mord">5</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">a</span></span></span></span>，z=7km 是标高；由此可知地表气压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">p_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和气压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> 二者在同一个公式里，因此二者单位必须统一（ERA5 数据里地表气压单位是 Pa，而压力坐标的单位是 Pa，单位并不统一）；</li>
</ol>
<p>通过这个公式我们也知道 MPTRAC 的 <code>输入起始高度z</code>  是 <code>log-pressure height</code> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mo>−</mo><mi>H</mi><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mi>p</mi><msub><mi>p</mi><mn>0</mn></msub></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z=-H\ln(\frac{p}{p_0})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2311079999999999em;vertical-align:-0.481108em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>)， <code>输出结果Z</code>  表示的是 <code>位势高度</code> （单位是 km，与标高的单位一致），因此为保证计算结果可靠，地表气压和气压的单位应统一变为 Pa（位势高度正比于气压的对数值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\ln p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span></span></span>, 如果气压 p 值很小，则位势高度 z 的结果也很小）</p>
<p>此外输入数据（如 era5 数据）的垂直层数（气压层数据）应尽可能多，以便 MPTRAC 在垂直方向上的插值和外推结果合理。（第一次用 MPTRAC 时，输入数据垂直层数就很少，只有 4、5 层，因此最后模拟出的结果如位势高度 Z 出现很多负值，其它变量如温度、风速等也有很多不合理的数据，这就是因为垂直层数太少且输入的气压数据值超过了模式规定的平均地表气压值 1013.25 hPa，导致模式外推和插值的结果出现负值）</p>
<ol start="2">
<li>在利用小时数据进行输入和输出时，需要注意官网给的例子是以一天为间隔进行模拟的，因此直接套用它的代码仅能得到间隔 1 天的输出 atm 和 grid 结果，这是因为 MPTRAC 默认 atm 和 grid 的结果是一天输出一次的（ <code>ATM_DT_OUT=86400，GRID_DT_OUT=86400</code> ），故使用小时数据的时候需要添加并修改 ATM_DT_OUT 和 GRID_DT_OUT (单位是秒)(官网例子是并没有这两个代码的，需要自己添加)</li>
</ol>
<p>比较<br>
 <code>ATM_DT_OUT</code>  和 <code>GRID_DT_OUT</code>  表示模拟的 atm 和 grid 结果每隔多久输出一次<br>
 <code>DT_MET</code> ：Time step of meteo data 输入气象数据的时间间隔，每两个 nc 文件之间的相差时间 (s)（例子是每 24h 一个输入文件）；<br>
 <code>MET_DT_OUT</code> ：Time step for sampling of meteo data along trajectories 采样时间（模式模拟的结果的输出间隔时间 / 每隔多久模拟一次）</p>
<ol start="3">
<li>
<p>官网给的例子是计算前向轨迹的，如果设置 <code>后向轨迹计算</code> ，一方面需要 <code>起始时间和终止时间需要互换</code> ，也就是起始时间是常规的事件结束的时间（t0=t），终止时间是事件开始时间（t1=t-x）；另一方面，需要在 trac.ctl 里面添加 <code>Direction ＝ -1</code> 。<br>
direction 就是反向轨迹的开关， <code>ctl就是控制参数</code> ，trac.ctl 就是控制 trac 的参数，而 direction 是 trac 这个程序（计算轨迹）的参数，所以放在里面。<br>
其实这些命令的位置不是这么重要，甚至可以把 $trac/atm_init（设置初始条件）这一部分的 init_t0 那些放进 trac.ctl 里面，不过这个是单独给 atm_init 这个程序的参数，所以单独拎出来<br>
这三个 <code>atm_init，atm_split，trac分别表示三个程序（设置初始条件，分割粒子，计算轨迹）</code> ，关于里面的参数一部分在源码里，一部分在第二部分 trac.ctl 文件里<br>
至于为啥 atm_init 也会调用 trac.ctl 文件，这是因为那些变量 qnt name 也是需要的，具体需要哪些参数，可以查一下 atm_init 代码里面。<br>
trac.ctl 和 trac 的区别是：trac.ctl 是参数文件，而 trac 是计算程序</p>
</li>
<li>
<p>正常运行 MPTRAC 是没有产生运行日志的（都在终端命令行显示了），如果想要生成运行日志（以 log 开头的文件），则在运行 trac 的时候，尾巴上加上一个 <code>| tee log.txt</code> <br>
<img data-src="5.png" alt title="图5"></p>
</li>
<li>
<p>编译的时候用了 <code>Werror</code> ，所有警告都会被当成错误来处理（所以有警告好像就会中止，但其实并没没有终止）。为防止因为警告而终止编译，把 <code>mptrac/src/</code>  下面的 <code>Makefile</code>  文件里面的 <code>-Werror</code>  删掉再编译，修改完成后保存，在 mptrac/src/ 目录下再重新 <code>编译make</code> （make 就是编译命令）。<br>
<img data-src="6.png" alt title="图6"></p>
</li>
</ol>
<p>因为之前未统一地表气压和气压坐标的单位，代码有小问题，现修改如下</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># make era5 data compatible with the MPTRAC model input data</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># make era5 data pressure levels be descending and make pressure levels unit from hPa to Pa</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># select 27 levels to make the mptrac interpolation/extrapolation reasonable</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> xarray <span class="token keyword">as</span> xr</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># read file</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token builtin">dir</span> <span class="token operator">=</span> <span class="token string">'path'</span></pre></td></tr><tr><td data-num="10"></td><td><pre>a <span class="token operator">=</span> xr<span class="token punctuation">.</span>open_dataset<span class="token punctuation">(</span><span class="token builtin">dir</span> <span class="token operator">+</span> <span class="token string">'xxx.nc'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># flip 3-D variables and level</span></pre></td></tr><tr><td data-num="13"></td><td><pre>ciwc <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>ciwc<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>clwc <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>clwc<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>q <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>q<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>t <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>t<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>u <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>u<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>v <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>v<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>w <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>w<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>lev <span class="token operator">=</span> np<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>a<span class="token punctuation">.</span>level<span class="token punctuation">.</span>values<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span>  <span class="token comment"># descend, from hPa to Pa</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment"># read 2-D variables and coordinates, modify names</span></pre></td></tr><tr><td data-num="24"></td><td><pre>u10m <span class="token operator">=</span> a<span class="token punctuation">.</span>u10<span class="token punctuation">.</span>values  <span class="token comment"># 只能识别 u10m，不能识别 u10</span></pre></td></tr><tr><td data-num="25"></td><td><pre>v10m <span class="token operator">=</span> a<span class="token punctuation">.</span>v10<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="26"></td><td><pre>t2m <span class="token operator">=</span> a<span class="token punctuation">.</span>t2m<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="27"></td><td><pre>z <span class="token operator">=</span> a<span class="token punctuation">.</span>z<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="28"></td><td><pre>ps <span class="token operator">=</span> a<span class="token punctuation">.</span>sp<span class="token punctuation">.</span>values  <span class="token comment"># ps， 非 sp</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>lon <span class="token operator">=</span> a<span class="token punctuation">.</span>longitude<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="31"></td><td><pre>lat <span class="token operator">=</span> a<span class="token punctuation">.</span>latitude<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="32"></td><td><pre>time <span class="token operator">=</span> a<span class="token punctuation">.</span>time<span class="token punctuation">.</span>values</pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment"># create a new dataset</span></pre></td></tr><tr><td data-num="35"></td><td><pre>ds <span class="token operator">=</span> xr<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'ciwc'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  ciwc<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                 <span class="token string">'clwc'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  clwc<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                 <span class="token string">'q'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  q<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                 <span class="token string">'t'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  t<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                 <span class="token string">'u'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  u<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                 <span class="token string">'v'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  v<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>                 <span class="token string">'w'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lev'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  w<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="42"></td><td><pre>                 <span class="token string">'u10m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  u10m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="43"></td><td><pre>                 <span class="token string">'v10m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  v10m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre>                 <span class="token string">'t2m'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  t2m<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                 <span class="token string">'z'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  z<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>                 <span class="token string">'ps'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  ps<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>                coords<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"time"</span><span class="token punctuation">:</span> time<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="48"></td><td><pre>                        <span class="token string">"lev"</span><span class="token punctuation">:</span> lev<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="49"></td><td><pre>                        <span class="token string">"lat"</span><span class="token punctuation">:</span> lat<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="50"></td><td><pre>                        <span class="token string">"lon"</span><span class="token punctuation">:</span> lon<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>                        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment"># add attributes (optional)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'time'</span></pre></td></tr><tr><td data-num="55"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lev'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'pressure'</span></pre></td></tr><tr><td data-num="56"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lev'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Pa'</span></pre></td></tr><tr><td data-num="57"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lat'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'latitude'</span></pre></td></tr><tr><td data-num="58"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lat'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'degrees_north'</span></pre></td></tr><tr><td data-num="59"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'longitude'</span></pre></td></tr><tr><td data-num="60"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'lon'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'degrees_east'</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ciwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cloud ice water content'</span></pre></td></tr><tr><td data-num="63"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ciwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="64"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'clwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Cloud liquid water content'</span></pre></td></tr><tr><td data-num="65"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'clwc'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="66"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Specific humidity'</span></pre></td></tr><tr><td data-num="67"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'kg kg**-1'</span></pre></td></tr><tr><td data-num="68"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Temperature'</span></pre></td></tr><tr><td data-num="69"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'K'</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'U velocity'</span></pre></td></tr><tr><td data-num="72"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'V velocity'</span></pre></td></tr><tr><td data-num="73"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="74"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="75"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Vertical velocity'</span></pre></td></tr><tr><td data-num="76"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Pa s**-1'</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'10 metre U wind component'</span></pre></td></tr><tr><td data-num="79"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'10 metre V wind component'</span></pre></td></tr><tr><td data-num="80"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'u10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="81"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'v10m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m s**-1'</span></pre></td></tr><tr><td data-num="82"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t2m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'long_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'2 metre temperature'</span></pre></td></tr><tr><td data-num="83"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'t2m'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'K'</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Geopotential'</span></pre></td></tr><tr><td data-num="86"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'m**2 s**-2'</span></pre></td></tr><tr><td data-num="87"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ps'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'standard_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Surface_pressure'</span></pre></td></tr><tr><td data-num="88"></td><td><pre>ds<span class="token punctuation">[</span><span class="token string">'ps'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'units'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Pa'</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token comment"># generate a new netcdf file</span></pre></td></tr><tr><td data-num="91"></td><td><pre>ds<span class="token punctuation">.</span>to_netcdf<span class="token punctuation">(</span><span class="token builtin">dir</span> <span class="token operator">+</span> <span class="token string">'xxx.nc'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>a<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure>
      <div class="tags">
          <a href="/tags/model/" rel="tag"><i class="ic i-tag"></i> model</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2022-10-15 14:19:52" itemprop="dateModified" datetime="2022-10-15T14:19:52+08:00">2022-10-15</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="SL-Z WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="SL-Z Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="SL-Z PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>SL-Z <i class="ic i-at"><em>@</em></i>Earth Science
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/Model/Model-installation/mptrac%20run/" title="MPTRAC run">http://example.com/Model/Model-installation/mptrac run/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/Model/Model-installation/mptrac%20installation/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;images7.alphacoders.com&#x2F;744&#x2F;744860.png" title="MPTRAC installation">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> Model installation</span>
  <h3>MPTRAC installation</h3>
  </a>

    </div>
    <div class="item right">
    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-run-the-example"><span class="toc-number">1.</span> <span class="toc-text"> 1. run the example</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-first-program"><span class="toc-number">1.1.</span> <span class="toc-text"> (1) first program</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-second-program"><span class="toc-number">1.2.</span> <span class="toc-text"> (2) second program</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-third-program"><span class="toc-number">1.3.</span> <span class="toc-text"> (3) third program</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-fourth-program"><span class="toc-number">1.4.</span> <span class="toc-text"> (4) fourth program</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-fifth-program"><span class="toc-number">1.5.</span> <span class="toc-text"> (5) fifth program</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-run-the-case-of-2021-henan-precipitation"><span class="toc-number">2.</span> <span class="toc-text"> 2. run the case of 2021 Henan precipitation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-first-method"><span class="toc-number">2.1.</span> <span class="toc-text"> (1) first method</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-second-method"><span class="toc-number">2.2.</span> <span class="toc-text"> (2) second method</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-notice"><span class="toc-number">2.3.</span> <span class="toc-text"> (3) notice</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-reference"><span class="toc-number">3.</span> <span class="toc-text"> 3. reference</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-update-on-15-oct-2022"><span class="toc-number">4.</span> <span class="toc-text"> 4. update on 15 Oct 2022</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li><a href="/Model/Model-installation/mptrac%20installation/" rel="bookmark" title="MPTRAC installation">MPTRAC installation</a></li><li class="active"><a href="/Model/Model-installation/mptrac%20run/" rel="bookmark" title="MPTRAC run">MPTRAC run</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="SL-Z"
      data-src="/images/maomi.jpg">
  <p class="name" itemprop="name">SL-Z</p>
  <div class="description" itemprop="description">DESS, THU</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">5</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">4</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3poYW5nc2xUSFU=" title="https:&#x2F;&#x2F;github.com&#x2F;zhangslTHU"><i class="ic i-github"></i></span>
      <span class="exturl item google" data-url="aHR0cHM6Ly9wbHVzLmdvb2dsZS5jb20=" title="https:&#x2F;&#x2F;plus.google.com"><i class="ic i-google"></i></span>
      <span class="exturl item stackoverflow" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbQ==" title="https:&#x2F;&#x2F;stackoverflow.com"><i class="ic i-stack-overflow"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Tools-for-Win-system/" title="In Tools for Win-system">Tools for Win-system</a>
</div>

    <span><a href="/Tools-for-Win-system/setup%20website/" title="setup website">setup website</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Tools-for-Win-system/" title="In Tools for Win-system">Tools for Win-system</a>
</div>

    <span><a href="/Tools-for-Win-system/introduction%20to%20hexo/" title="Introduction to Hexo">Introduction to Hexo</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Python/" title="In Python">Python</a>
</div>

    <span><a href="/Python/python-skills/" title="Python Skills">Python Skills</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Model/" title="In Model">Model</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Model/Model-installation/" title="In Model installation">Model installation</a>
</div>

    <span><a href="/Model/Model-installation/mptrac%20run/" title="MPTRAC run">MPTRAC run</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Model/" title="In Model">Model</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Model/Model-installation/" title="In Model installation">Model installation</a>
</div>

    <span><a href="/Model/Model-installation/mptrac%20installation/" title="MPTRAC installation">MPTRAC installation</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2022</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">SL-Z @ magic zlier</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'Model/Model-installation/mptrac run/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,copy_tex: true,
    katex: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
